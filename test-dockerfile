FROM r-base

!GITPULL ssh://git@stash.broadinstitute.org:7999/cpds/atlantis.git master /atlantis

!ADD /install_r_modules EOF
options(repos = c(
	"https://iwww.broadinstitute.org/~datasci/R-packages",
	"https://cran.cnr.berkeley.edu"))
install.packages(c('atlantisPartyMod', 'reshape2', 'AUC', 'RColorBrewer', 'foreach', 'caTools'))
EOF

RUN Rscript /install_r_modules
RUN cd /atlantis && R CMD INSTALL .
COPY dist/phlock2-0.0.0.tar.gz /phlock.tar.gz
RUN tar xzf /phlock.tar.gz && cd phlock2-0.0.0 && python setup.py install
